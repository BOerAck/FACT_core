{% extends "analysis_plugins/general_information.html" %}

{% block analysis_result_details %}
<style>
    .information-leaks-pre {
        padding: 5px;
        width: 100%;
        white-space: pre-wrap;
        overflow-y: scroll;
        overflow-x: hidden;
        display: block;
        font-family: monospace;
        margin: 0 0;
        color: #f8f8f8;
        background-color: #333;
        max-height: 500px;
    }
</style>

{% for key in firmware.processed_analysis[selected_analysis].keys() | sort %}
    {% if key | is_not_mandatory_analysis_entry %}
        <tr>
            <td>
                {{ key }}
            </td>
            <td class="m-0 p-0">
                <div class="clickable pt-2 pl-3" data-toggle="collapse" data-target="#{{ key }}">
                    <i class="fas fa-angle-down mb-2 pt-2"></i>
                </div>

                <div class="collapse w-100" id="{{ key }}">
                    {% if firmware.processed_analysis[selected_analysis][key] | is_list%}
                        {% for value in firmware.processed_analysis[selected_analysis][key] %}
                             <ul>
                                <li>{{ value }}</li>
                             </ul>
                        {% endfor %}
                    {% else %}
                        <pre class="information-leaks-pre">{{ firmware.processed_analysis[selected_analysis][key] }}</pre>
                    {%endif%}
                </div>
            </td>
        </tr>
    {% endif %}
{% endfor %}

{% endblock %}
